// –°–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
const Languages = {
    ru: {
        title: "BULLSTRIKE",
        balance: "–ë–∞–ª–∞–Ω—Å:",
        points: "–æ—á–∫–æ–≤",
        startGame: "–ù–ê–ß–ê–¢–¨ –ò–ì–†–£",
        missions: "–ó–ê–î–ê–ù–ò–Ø",
        shop: "–ú–ê–ì–ê–ó–ò–ù",
        moneyButton: "üí∞ +80–ú –û–ß–ö–û–í",
        language: "üåê –Ø–ó–´–ö",
        back: "–ù–ê–ó–ê–î",
        ammo: "–ü–∞—Ç—Ä–æ–Ω—ã:",
        score: "–û—á–∫–∏:",
        health: "–ó–¥–æ—Ä–æ–≤—å–µ:",
        fire: "–û–ì–û–ù–¨",
        reload: "–ü–ï–†–ï–ó–ê–†–Ø–î–ö–ê",
        gameOver: "–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê",
        yourScore: "–í–∞—à —Å—á–µ—Ç:",
        completedMissions: "–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è:",
        playAgain: "–ò–ì–†–ê–¢–¨ –°–ù–û–í–ê",
        mainMenu: "–í –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ",
        gameTasks: "–ò–≥—Ä–æ–≤—ã–µ",
        socialTasks: "–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è",
        languageTitle: "–í–´–ë–û–† –Ø–ó–´–ö–ê",
        missionsTitle: "–ó–ê–î–ê–ù–ò–Ø",
        shopTitle: "–ú–ê–ì–ê–ó–ò–ù",
        gameOverTitle: "–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê",
        orientationWarning: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–≤–µ—Ä–Ω–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ",
        // –ò–≥—Ä–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è
        mission1: "–£–±–∏—Ç—å 10 –∑–æ–º–±–∏",
        mission2: "–ù–∞–±—Ä–∞—Ç—å 1000 –æ—á–∫–æ–≤",
        mission3: "–í—ã–∂–∏—Ç—å 5 –º–∏–Ω—É—Ç",
        mission4: "–£–±–∏—Ç—å 50 –∑–æ–º–±–∏",
        mission5: "–ù–∞–±—Ä–∞—Ç—å 5000 –æ—á–∫–æ–≤",
        mission6: "–í—ã–∂–∏—Ç—å 10 –º–∏–Ω—É—Ç",
        mission7: "–£–±–∏—Ç—å 100 –∑–æ–º–±–∏",
        mission8: "–ù–∞–±—Ä–∞—Ç—å 10000 –æ—á–∫–æ–≤",
        mission9: "–í—ã–∂–∏—Ç—å 15 –º–∏–Ω—É—Ç",
        mission10: "–£–±–∏—Ç—å 200 –∑–æ–º–±–∏",
        mission11: "–ù–∞–±—Ä–∞—Ç—å 25000 –æ—á–∫–æ–≤",
        mission12: "–í—ã–∂–∏—Ç—å 20 –º–∏–Ω—É—Ç",
        mission13: "–ú–∞—Å—Ç–µ—Ä –≤—ã–∂–∏–≤–∞–Ω–∏—è",
        mission13Desc: "–í—ã–∂–∏—Ç—å 30 –º–∏–Ω—É—Ç –ø–æ–¥—Ä—è–¥",
        mission14: "–°–Ω–∞–π–ø–µ—Ä",
        mission14Desc: "–£–±–∏—Ç—å 50 –∑–æ–º–±–∏ –ø–æ–¥—Ä—è–¥ –±–µ–∑ –ø—Ä–æ–º–∞—Ö–∞",
        mission15: "–ë–µ–≥—É–Ω",
        mission15Desc: "–ü—Ä–æ–±–µ–∂–∞—Ç—å 1000 –º–µ—Ç—Ä–æ–≤",
        mission16: "–≠–∫–æ–Ω–æ–º–∏—Å—Ç",
        mission16Desc: "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–Ω–µ–µ 100 –ø–∞—Ç—Ä–æ–Ω–æ–≤ –¥–ª—è —É–±–∏–π—Å—Ç–≤–∞ 20 –∑–æ–º–±–∏",
        mission17: "–ù–æ—á–Ω–æ–π –æ—Ö–æ—Ç–Ω–∏–∫",
        mission17Desc: "–£–±–∏—Ç—å 30 –∑–æ–º–±–∏ –≤ —Ç–µ–º–Ω–æ—Ç–µ (–ø–æ—Å–ª–µ 5 –º–∏–Ω—É—Ç –∏–≥—Ä—ã)",
        mission18: "–°–∫–æ—Ä–æ—Å—Ç—Ä–µ–ª",
        mission18Desc: "–£–±–∏—Ç—å 10 –∑–æ–º–±–∏ –∑–∞ 30 —Å–µ–∫—É–Ω–¥",
        mission19: "–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å",
        mission19Desc: "–ü–æ—Å–µ—Ç–∏—Ç—å –≤—Å–µ 4 —É–≥–ª–∞ –∫–∞—Ä—Ç—ã",
        mission20: "–ë–µ—Ä—Å–µ—Ä–∫",
        mission20Desc: "–£–±–∏—Ç—å 100 –∑–æ–º–±–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏",
        mission21: "–í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å",
        mission21Desc: "–ò–≥—Ä–∞—Ç—å 1 —á–∞—Å –±–µ–∑ –ø–µ—Ä–µ—Ä—ã–≤–∞",
        mission22: "–ú–∞—Å—Ç–µ—Ä —Ç–æ—á–Ω–æ—Å—Ç–∏",
        mission22Desc: "–î–æ—Å—Ç–∏—á—å —Ç–æ—á–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–µ–ª—å–±—ã 90%",
        mission23: "–õ–µ–≥–µ–Ω–¥–∞",
        mission23Desc: "–ù–∞–±—Ä–∞—Ç—å 100000 –æ—á–∫–æ–≤ –∑–∞ –æ–¥–Ω—É –∏–≥—Ä—É",
        // –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
        socialMission1: "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ Telegram –∫–∞–Ω–∞–ª",
        socialMission2: "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ Telegram —á–∞—Ç",
        socialMission3: "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –≤ X (Twitter)",
        socialMission4: "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ YouTube",
        socialMission5: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –∏–≥—Ä–æ–π",
        socialMission6: "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ TON Society Central Asia",
        // –û–±—â–∏–µ —Ç–µ–∫—Å—Ç—ã –∑–∞–¥–∞–Ω–∏–π
        reward: "–ù–∞–≥—Ä–∞–¥–∞:",
        claimReward: "–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É",
        confirmSubscription: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É",
        share: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è",
        // –ú–∞–≥–∞–∑–∏–Ω
        shopItem1: "–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è",
        shopItem1Desc: "+20 –∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É –∑–¥–æ—Ä–æ–≤—å—é",
        shopItem2: "–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞",
        shopItem2Desc: "+25% –∫ —É—Ä–æ–Ω—É",
        shopItem3: "–£—Å–∫–æ—Ä–µ–Ω–∏–µ",
        shopItem3Desc: "+20% –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏—è",
        shopItem4: "–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–∞—Ç—Ä–æ–Ω–æ–≤",
        shopItem4Desc: "+10 –∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–∞—Ç—Ä–æ–Ω–æ–≤",
        shopItem5: "–ë—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞",
        shopItem5Desc: "-20% –∫ –≤—Ä–µ–º–µ–Ω–∏ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏",
        shopItem6: "–ë—Ä–æ–Ω—è",
        shopItem6Desc: "+15% –∫ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—é —É—Ä–æ–Ω—É",
        shopItem7: "–î–≤–æ–π–Ω–æ–π –≤—ã—Å—Ç—Ä–µ–ª",
        shopItem7Desc: "+10% —à–∞–Ω—Å –¥–≤–æ–π–Ω–æ–≥–æ –≤—ã—Å—Ç—Ä–µ–ª–∞",
        price: "–¶–µ–Ω–∞:",
        buy: "–ö—É–ø–∏—Ç—å",
        limitInfo: "–ú–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å —Ç–æ–ª—å–∫–æ 3 —Ä–∞–∑–∞ —Å –ø–µ—Ä–µ—Ä—ã–≤–æ–º –≤ 5 –¥–Ω–µ–π",
        moneyReceived: "–ü–æ–ª—É—á–µ–Ω–æ 80 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –æ—á–∫–æ–≤!"
    },
    en: {
        title: "BULLSTRIKE",
        balance: "Balance:",
        points: "points",
        startGame: "START GAME",
        missions: "MISSIONS",
        shop: "SHOP",
        moneyButton: "üí∞ +80M POINTS",
        language: "üåê LANGUAGE",
        back: "BACK",
        ammo: "Ammo:",
        score: "Score:",
        health: "Health:",
        fire: "FIRE",
        reload: "RELOAD",
        gameOver: "GAME OVER",
        yourScore: "Your score:",
        completedMissions: "Completed missions:",
        playAgain: "PLAY AGAIN",
        mainMenu: "MAIN MENU",
        gameTasks: "Game Tasks",
        socialTasks: "Social Tasks",
        languageTitle: "LANGUAGE SELECTION",
        missionsTitle: "MISSIONS",
        shopTitle: "SHOP",
        gameOverTitle: "GAME OVER",
        orientationWarning: "Please rotate your device horizontally",
        // Game missions
        mission1: "Kill 10 zombies",
        mission2: "Score 1000 points",
        mission3: "Survive 5 minutes",
        mission4: "Kill 50 zombies",
        mission5: "Score 5000 points",
        mission6: "Survive 10 minutes",
        mission7: "Kill 100 zombies",
        mission8: "Score 10000 points",
        mission9: "Survive 15 minutes",
        mission10: "Kill 200 zombies",
        mission11: "Score 25000 points",
        mission12: "Survive 20 minutes",
        mission13: "Survival Master",
        mission13Desc: "Survive 30 minutes in a row",
        mission14: "Sniper",
        mission14Desc: "Kill 50 zombies in a row without missing",
        mission15: "Runner",
        mission15Desc: "Run 1000 meters",
        mission16: "Economist",
        mission16Desc: "Use less than 100 bullets to kill 20 zombies",
        mission17: "Night Hunter",
        mission17Desc: "Kill 30 zombies in the dark (after 5 minutes of play)",
        mission18: "Rapid Fire",
        mission18Desc: "Kill 10 zombies in 30 seconds",
        mission19: "Explorer",
        mission19Desc: "Visit all 4 corners of the map",
        mission20: "Berserker",
        mission20Desc: "Kill 100 zombies without reloading",
        mission21: "Endurance",
        mission21Desc: "Play 1 hour without a break",
        mission22: "Accuracy Master",
        mission22Desc: "Achieve 90% shooting accuracy",
        mission23: "Legend",
        mission23Desc: "Score 100000 points in one game",
        // Social missions
        socialMission1: "Subscribe to Telegram channel",
        socialMission2: "Subscribe to Telegram chat",
        socialMission3: "Subscribe to X (Twitter)",
        socialMission4: "Subscribe to YouTube",
        socialMission5: "Share the game",
        socialMission6: "Subscribe to TON Society Central Asia",
        // Common mission texts
        reward: "Reward:",
        claimReward: "Claim reward",
        confirmSubscription: "Confirm subscription",
        share: "Share",
        // Shop
        shopItem1: "Health increase",
        shopItem1Desc: "+20 to maximum health",
        shopItem2: "Damage increase",
        shopItem2Desc: "+25% to damage",
        shopItem3: "Speed boost",
        shopItem3Desc: "+20% to movement speed",
        shopItem4: "Ammo increase",
        shopItem4Desc: "+10 to maximum ammo capacity",
        shopItem5: "Fast reload",
        shopItem5Desc: "-20% to reload time",
        shopItem6: "Armor",
        shopItem6Desc: "+15% to damage resistance",
        shopItem7: "Double shot",
        shopItem7Desc: "+10% chance for double shot",
        price: "Price:",
        buy: "Buy",
        limitInfo: "Can only be purchased 3 times with a 5-day cooldown",
        moneyReceived: "Received 80 million points!"
    },
    ja: {
        title: "„Éñ„É´„Çπ„Éà„É©„Ç§„ÇØ",
        balance: "„Éê„É©„É≥„Çπ:",
        points: "„Éù„Ç§„É≥„Éà",
        startGame: "„Ç≤„Éº„É†ÈñãÂßã",
        missions: "„Éü„ÉÉ„Ç∑„Éß„É≥",
        shop: "„Ç∑„Éß„ÉÉ„Éó",
        moneyButton: "üí∞ +80M „Éù„Ç§„É≥„Éà",
        language: "üåê Ë®ÄË™û",
        back: "Êàª„Çã",
        ammo: "ÂºæËñ¨:",
        score: "„Çπ„Ç≥„Ç¢:",
        health: "‰ΩìÂäõ:",
        fire: "Áô∫Â∞Ñ",
        reload: "„É™„É≠„Éº„Éâ",
        gameOver: "„Ç≤„Éº„É†„Ç™„Éº„Éê„Éº",
        yourScore: "„ÅÇ„Å™„Åü„ÅÆ„Çπ„Ç≥„Ç¢:",
        completedMissions: "ÂÆå‰∫Ü„Åó„Åü„Éü„ÉÉ„Ç∑„Éß„É≥:",
        playAgain: "„ÇÇ„ÅÜ‰∏ÄÂ∫¶„Éó„É¨„Ç§",
        mainMenu: "„É°„Ç§„É≥„É°„Éã„É•„Éº",
        gameTasks: "„Ç≤„Éº„É†„Çø„Çπ„ÇØ",
        socialTasks: "„ÇΩ„Éº„Ç∑„É£„É´„Çø„Çπ„ÇØ",
        languageTitle: "Ë®ÄË™ûÈÅ∏Êäû",
        missionsTitle: "„Éü„ÉÉ„Ç∑„Éß„É≥",
        shopTitle: "„Ç∑„Éß„ÉÉ„Éó",
        gameOverTitle: "„Ç≤„Éº„É†„Ç™„Éº„Éê„Éº",
        orientationWarning: "„Éá„Éê„Ç§„Çπ„ÇíÊ®™Âêë„Åç„Å´ÂõûËª¢„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
        // „Ç≤„Éº„É†„Éü„ÉÉ„Ç∑„Éß„É≥
        mission1: "„Çæ„É≥„Éì„Çí10‰ΩìÂÄí„Åô",
        mission2: "1000„Éù„Ç§„É≥„Éà„ÇíÁç≤Âæó",
        mission3: "5ÂàÜÈñìÁîüÂ≠ò",
        mission4: "„Çæ„É≥„Éì„Çí50‰ΩìÂÄí„Åô",
        mission5: "5000„Éù„Ç§„É≥„Éà„ÇíÁç≤Âæó",
        mission6: "10ÂàÜÈñìÁîüÂ≠ò",
        mission7: "„Çæ„É≥„Éì„Çí100‰ΩìÂÄí„Åô",
        mission8: "10000„Éù„Ç§„É≥„Éà„ÇíÁç≤Âæó",
        mission9: "15ÂàÜÈñìÁîüÂ≠ò",
        mission10: "„Çæ„É≥„Éì„Çí200‰ΩìÂÄí„Åô",
        mission11: "25000„Éù„Ç§„É≥„Éà„ÇíÁç≤Âæó",
        mission12: "20ÂàÜÈñìÁîüÂ≠ò",
        mission13: "„Çµ„Éê„Ç§„Éê„É´„Éû„Çπ„Çø„Éº",
        mission13Desc: "30ÂàÜÈñìÈÄ£Á∂ö„ÅßÁîüÂ≠ò",
        mission14: "„Çπ„Éä„Ç§„Éë„Éº",
        mission14Desc: "50‰Ωì„ÅÆ„Çæ„É≥„Éì„ÇíÈÄ£Á∂ö„ÅßÂ§ñ„Åï„Åö„Å´ÂÄí„Åô",
        mission15: "„É©„É≥„Éä„Éº",
        mission15Desc: "1000„É°„Éº„Éà„É´Ëµ∞„Çã",
        mission16: "„Ç®„Ç≥„Éé„Éü„Çπ„Éà",
        mission16Desc: "100Áô∫Êú™Ê∫Ä„ÅÆÂºæ„Åß20‰Ωì„ÅÆ„Çæ„É≥„Éì„ÇíÂÄí„Åô",
        mission17: "„Éä„Ç§„Éà„Éè„É≥„Çø„Éº",
        mission17Desc: "ÊöóÈóá„Åß30‰Ωì„ÅÆ„Çæ„É≥„Éì„ÇíÂÄí„ÅôÔºà5ÂàÜÈñì„Éó„É¨„Ç§ÂæåÔºâ",
        mission18: "„É©„Éî„ÉÉ„Éâ„Éï„Ç°„Ç§„Ç¢",
        mission18Desc: "30Áßí„Åß10‰Ωì„ÅÆ„Çæ„É≥„Éì„ÇíÂÄí„Åô",
        mission19: "„Ç®„ÇØ„Çπ„Éó„É≠„Éº„É©„Éº",
        mission19Desc: "„Éû„ÉÉ„Éó„ÅÆ4„Å§„ÅÆËßí„Åô„Åπ„Å¶„ÇíË®™„Çå„Çã",
        mission20: "„Éê„Éº„Çµ„Éº„Ç´„Éº",
        mission20Desc: "„É™„É≠„Éº„Éâ„Åõ„Åö„Å´100‰Ωì„ÅÆ„Çæ„É≥„Éì„ÇíÂÄí„Åô",
        mission21: "ÊåÅ‰πÖÂäõ",
        mission21Desc: "1ÊôÇÈñì‰ºëÊÜ©„Å™„Åó„Åß„Éó„É¨„Ç§",
        mission22: "Á≤æÂ∫¶„Éû„Çπ„Çø„Éº",
        mission22Desc: "90%„ÅÆÂ∞ÑÊíÉÁ≤æÂ∫¶„ÇíÈÅîÊàê",
        mission23: "‰ºùË™¨",
        mission23Desc: "1„Ç≤„Éº„É†„Åß100000„Éù„Ç§„É≥„Éà„ÇíÁç≤Âæó",
        // „ÇΩ„Éº„Ç∑„É£„É´„Éü„ÉÉ„Ç∑„Éß„É≥
        socialMission1: "Telegram„ÉÅ„É£„É≥„Éç„É´„Å´ÁôªÈå≤",
        socialMission2: "Telegram„ÉÅ„É£„ÉÉ„Éà„Å´ÁôªÈå≤",
        socialMission3: "XÔºàTwitterÔºâ„Å´ÁôªÈå≤",
        socialMission4: "YouTube„Å´ÁôªÈå≤",
        socialMission5: "„Ç≤„Éº„É†„Çí„Ç∑„Çß„Ç¢",
        socialMission6: "TON Society Central Asia„Å´ÁôªÈå≤",
        // ÂÖ±ÈÄö„Éü„ÉÉ„Ç∑„Éß„É≥„ÉÜ„Ç≠„Çπ„Éà
        reward: "Â†±ÈÖ¨:",
        claimReward: "Â†±ÈÖ¨„ÇíÂèó„ÅëÂèñ„Çã",
        confirmSubscription: "ÁôªÈå≤„ÇíÁ¢∫Ë™ç",
        share: "„Ç∑„Çß„Ç¢",
        // „Ç∑„Éß„ÉÉ„Éó
        shopItem1: "‰ΩìÂäõÂ¢óÂä†",
        shopItem1Desc: "ÊúÄÂ§ß‰ΩìÂäõ+20",
        shopItem2: "„ÉÄ„É°„Éº„Ç∏Â¢óÂä†",
        shopItem2Desc: "„ÉÄ„É°„Éº„Ç∏+25%",
        shopItem3: "„Çπ„Éî„Éº„Éâ„Éñ„Éº„Çπ„Éà",
        shopItem3Desc: "ÁßªÂãïÈÄüÂ∫¶+20%",
        shopItem4: "ÂºæËñ¨Â¢óÂä†",
        shopItem4Desc: "ÊúÄÂ§ßÂºæËñ¨ÂÆπÈáè+10",
        shopItem5: "È´òÈÄü„É™„É≠„Éº„Éâ",
        shopItem5Desc: "„É™„É≠„Éº„ÉâÊôÇÈñì-20%",
        shopItem6: "„Ç¢„Éº„Éû„Éº",
        shopItem6Desc: "„ÉÄ„É°„Éº„Ç∏ËÄêÊÄß+15%",
        shopItem7: "„ÉÄ„Éñ„É´„Ç∑„Éß„ÉÉ„Éà",
        shopItem7Desc: "„ÉÄ„Éñ„É´„Ç∑„Éß„ÉÉ„ÉàÁ¢∫Áéá+10%",
        price: "‰æ°Ê†º:",
        buy: "Ë≥ºÂÖ•",
        limitInfo: "5Êó•Èñì„ÅÆ„ÇØ„Éº„É´„ÉÄ„Ç¶„É≥„Åß3Âõû„Åæ„ÅßË≥ºÂÖ•ÂèØËÉΩ",
        moneyReceived: "8000‰∏á„Éù„Ç§„É≥„Éà„ÇíÁç≤Âæó„Åó„Åæ„Åó„ÅüÔºÅ"
    }
};

let currentLanguage = 'ru';

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–º–µ–Ω—ã —è–∑—ã–∫–∞
function changeLanguage(lang) {
    currentLanguage = lang;
    GameData.language = lang;
    GameData.save();
    
    const langData = Languages[lang];
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –ø–æ–≤–æ—Ä–æ—Ç–µ —ç–∫—Ä–∞–Ω–∞
    document.getElementById('orientation-warning').textContent = langData.orientationWarning;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
    document.getElementById('menu-title').textContent = langData.title;
    document.getElementById('balance-text').textContent = langData.balance;
    document.getElementById('points-text').textContent = langData.points;
    document.getElementById('start-btn').textContent = langData.startGame;
    document.getElementById('missions-btn').textContent = langData.missions;
    document.getElementById('shop-btn').textContent = langData.shop;
    document.getElementById('money-btn').textContent = langData.moneyButton;
    document.getElementById('language-btn').textContent = langData.language;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —ç–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞
    document.getElementById('language-title').textContent = langData.languageTitle;
    document.getElementById('language-back').textContent = langData.back;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —ç–∫—Ä–∞–Ω –∑–∞–¥–∞–Ω–∏–π
    document.getElementById('missions-title').textContent = langData.missionsTitle;
    document.getElementById('game-tab').textContent = langData.gameTasks;
    document.getElementById('social-tab').textContent = langData.socialTasks;
    document.getElementById('missions-back').textContent = langData.back;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–≥—Ä–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è
    const gameMissions = document.querySelectorAll('#game-missions .mission');
    gameMissions.forEach(mission => {
        const missionId = mission.dataset.id;
        const titleElement = mission.querySelector('h3');
        const rewardElement = mission.querySelector('p');
        const claimBtn = mission.querySelector('.claim-btn');
        
        if (titleElement) {
            if (missionId >= 13 && missionId <= 23) {
                // –ó–∞–¥–∞–Ω–∏—è —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
                const descKey = `mission${missionId}Desc`;
                if (langData[descKey]) {
                    titleElement.textContent = langData[`mission${missionId}`];
                    // –ù–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º (–≤—Ç–æ—Ä–æ–π p)
                    const descElement = mission.querySelectorAll('p')[1];
                    if (descElement) {
                        descElement.textContent = langData[descKey];
                    }
                }
            } else {
                titleElement.textContent = langData[`mission${missionId}`];
            }
        }
        
        if (rewardElement && !mission.querySelectorAll('p')[1]) {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π p (–Ω–∞–≥—Ä–∞–¥–∞) –µ—Å–ª–∏ –Ω–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è
            const rewardText = rewardElement.textContent.replace(/^–ù–∞–≥—Ä–∞–¥–∞: \d+ –æ—á–∫–æ–≤$/, 
                `${langData.reward} ${rewardElement.textContent.match(/\d+/)[0]} ${langData.points}`);
            rewardElement.textContent = rewardText;
        } else if (rewardElement && mission.querySelectorAll('p').length > 2) {
            // –ï—Å–ª–∏ –µ—Å—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ, –æ–±–Ω–æ–≤–ª—è–µ–º —Ç—Ä–µ—Ç–∏–π p (–Ω–∞–≥—Ä–∞–¥–∞)
            const rewardP = mission.querySelectorAll('p')[2];
            if (rewardP) {
                const rewardText = rewardP.textContent.replace(/^–ù–∞–≥—Ä–∞–¥–∞: \d+ –æ—á–∫–æ–≤$/, 
                    `${langData.reward} ${rewardP.textContent.match(/\d+/)[0]} ${langData.points}`);
                rewardP.textContent = rewardText;
            }
        }
        
        if (claimBtn) {
            claimBtn.textContent = langData.claimReward;
        }
    });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
    const socialMissions = document.querySelectorAll('#social-missions .mission');
    socialMissions.forEach(mission => {
        const missionId = mission.dataset.id;
        const titleElement = mission.querySelector('h3');
        const rewardElement = mission.querySelector('p');
        const claimBtn = mission.querySelector('.claim-btn');
        const shareBtn = mission.querySelector('.share-btn');
        
        if (titleElement) {
            titleElement.textContent = langData[`socialMission${missionId.slice(1)}`];
        }
        
        if (rewardElement) {
            const rewardText = rewardElement.textContent.replace(/^–ù–∞–≥—Ä–∞–¥–∞: \d+ –æ—á–∫–æ–≤$/, 
                `${langData.reward} ${rewardElement.textContent.match(/\d+/)[0]} ${langData.points}`);
            rewardElement.textContent = rewardText;
        }
        
        if (claimBtn) {
            if (missionId === 's5') {
                claimBtn.textContent = langData.claimReward;
            } else {
                claimBtn.textContent = langData.confirmSubscription;
            }
        }
        
        if (shareBtn) {
            shareBtn.innerHTML = `<i class="fas fa-share"></i> ${langData.share}`;
        }
    });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —ç–∫—Ä–∞–Ω –º–∞–≥–∞–∑–∏–Ω–∞
    document.getElementById('shop-title').textContent = langData.shopTitle;
    document.getElementById('shop-back').textContent = langData.back;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä—ã –≤ –º–∞–≥–∞–∑–∏–Ω–µ
    const shopItems = document.querySelectorAll('.shop-item');
    shopItems.forEach(item => {
        const itemId = item.dataset.id;
        const titleElement = item.querySelector('h3');
        const descElement = item.querySelector('p');
        const priceElement = item.querySelector('p:nth-child(3)');
        const buyBtn = item.querySelector('.buy-btn');
        const limitInfo = item.querySelector('.limit-info');
        
        if (titleElement) {
            titleElement.textContent = langData[`shopItem${itemId}`];
        }
        
        if (descElement && !priceElement) {
            descElement.textContent = langData[`shopItem${itemId}Desc`];
        } else if (descElement && priceElement) {
            descElement.textContent = langData[`shopItem${itemId}Desc`];
            priceElement.textContent = `${langData.price} ${priceElement.textContent.match(/\d+/)[0]} ${langData.points}`;
        }
        
        if (buyBtn) {
            buyBtn.textContent = langData.buy;
        }
        
        if (limitInfo) {
            limitInfo.textContent = langData.limitInfo;
        }
    });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —ç–∫—Ä–∞–Ω –ø—Ä–æ–∏–≥—Ä—ã—à–∞
    document.getElementById('game-over-title').textContent = langData.gameOverTitle;
    document.getElementById('your-score-text').textContent = langData.yourScore;
    document.getElementById('completed-missions-text').textContent = langData.completedMissions;
    document.getElementById('restart-btn').textContent = langData.playAgain;
    document.getElementById('menu-btn').textContent = langData.mainMenu;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–≥—Ä–æ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    document.getElementById('ammo-text').textContent = langData.ammo;
    document.getElementById('score-text').textContent = langData.score;
    document.getElementById('health-text').textContent = langData.health;
    document.getElementById('shoot-btn').textContent = langData.fire;
    document.getElementById('reload-btn').textContent = langData.reload;
}

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
const GameData = {
    totalScore: 0,
    maxHealth: 100,
    damageMultiplier: 1,
    speedMultiplier: 1,
    ammoCapacity: 30,
    reloadTimeMultiplier: 1,
    damageResistance: 0,
    doubleShotChance: 0,
    speedBoostsPurchased: 0,
    lastSpeedBoostPurchase: 0,
    language: 'ru',
    missions: {
        // –ò–≥—Ä–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è
        1: { killed: 0, completed: false },
        2: { score: 0, completed: false },
        3: { time: 0, completed: false },
        4: { killed: 0, completed: false },
        5: { score: 0, completed: false },
        6: { time: 0, completed: false },
        7: { killed: 0, completed: false },
        8: { score: 0, completed: false },
        9: { time: 0, completed: false },
        10: { killed: 0, completed: false },
        11: { score: 0, completed: false },
        12: { time: 0, completed: false },
        13: { time: 0, completed: false },
        14: { consecutiveKills: 0, completed: false },
        15: { distance: 0, completed: false },
        16: { efficientKills: 0, completed: false },
        17: { nightKills: 0, completed: false },
        18: { speedKills: 0, completed: false },
        19: { corners: 0, completed: false },
        20: { noReloadKills: 0, completed: false },
        21: { time: 0, completed: false },
        22: { accuracy: 0, completed: false },
        23: { score: 0, completed: false },
        // –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
        s1: { completed: false },
        s2: { completed: false },
        s3: { completed: false },
        s4: { completed: false },
        s5: { completed: false }
    },
    
    save() {
        localStorage.setItem('zombieShooterData', JSON.stringify({
            totalScore: this.totalScore,
            maxHealth: this.maxHealth,
            damageMultiplier: this.damageMultiplier,
            speedMultiplier: this.speedMultiplier,
            ammoCapacity: this.ammoCapacity,
            reloadTimeMultiplier: this.reloadTimeMultiplier,
            damageResistance: this.damageResistance,
            doubleShotChance: this.doubleShotChance,
            speedBoostsPurchased: this.speedBoostsPurchased,
            lastSpeedBoostPurchase: this.lastSpeedBoostPurchase,
            language: this.language,
            missions: this.missions
        }));
    },
    
    load() {
        const data = localStorage.getItem('zombieShooterData');
        if (data) {
            const parsed = JSON.parse(data);
            this.totalScore = parsed.totalScore;
            this.maxHealth = parsed.maxHealth;
            this.damageMultiplier = parsed.damageMultiplier;
            this.speedMultiplier = parsed.speedMultiplier || 1;
            this.ammoCapacity = parsed.ammoCapacity || 30;
            this.reloadTimeMultiplier = parsed.reloadTimeMultiplier || 1;
            this.damageResistance = parsed.damageResistance || 0;
            this.doubleShotChance = parsed.doubleShotChance || 0;
            this.speedBoostsPurchased = parsed.speedBoostsPurchased || 0;
            this.lastSpeedBoostPurchase = parsed.lastSpeedBoostPurchase || 0;
            this.language = parsed.language || 'ru';
            this.missions = parsed.missions || {};
            
            // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
            if (!this.missions.s1) this.missions.s1 = { completed: false };
            if (!this.missions.s2) this.missions.s2 = { completed: false };
            if (!this.missions.s3) this.missions.s3 = { completed: false };
            if (!this.missions.s4) this.missions.s4 = { completed: false };
            if (!this.missions.s5) this.missions.s5 = { completed: false };
            if (!this.missions.s6) this.missions.s6 = { completed: false };
        } else {
            // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å –ø—É—Å—Ç—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
            this.missions = {};
            this.missions.s1 = { completed: false };
            this.missions.s2 = { completed: false };
            this.missions.s3 = { completed: false };
            this.missions.s4 = { completed: false };
            this.missions.s5 = { completed: false };
            this.missions.s6 = { completed: false };
        }
        this.updateUI();
    },
    
    updateUI() {
        document.getElementById('total-score').textContent = this.totalScore;
    }
};

class ZombieShooter {
    constructor() {
        if (typeof THREE === 'undefined') {
            throw new Error('Three.js –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω!');
        }
        
        this.scene = new THREE.Scene();
        this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        this.renderer = new THREE.WebGLRenderer({
            canvas: document.getElementById('game'),
            antialias: true
        });
        
        this.renderer.setSize(window.innerWidth, window.innerHeight);
        this.renderer.setClearColor(0x000000);
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–≤—É–∫–∞ –≤—ã—Å—Ç—Ä–µ–ª–∞
        this.shootSound = new Audio('pistolet_zvuk.mp3');
        this.shootSound.addEventListener('error', (e) => {
            console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∑–≤—É–∫ –≤—ã—Å—Ç—Ä–µ–ª–∞:', e);
        });
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—Å—Ç—É—Ä—ã –∑–µ–º–ª–∏
        const textureLoader = new THREE.TextureLoader();
        this.groundTexture = textureLoader.load('texture.png', 
            // –§—É–Ω–∫—Ü–∏—è —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
            (texture) => {
                texture.wrapS = THREE.RepeatWrapping;
                texture.wrapT = THREE.RepeatWrapping;
                texture.repeat.set(4, 4);
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞—Ç–µ—Ä–∏–∞–ª –ø–æ–ª–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–∫—Å—Ç—É—Ä—ã
                if (this.floor) {
                    this.floor.material.map = texture;
                    this.floor.material.needsUpdate = true;
                }
            },
            // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏
            (progress) => {
                console.log('–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—Å—Ç—É—Ä—ã: ' + (progress.loaded / progress.total * 100) + '%');
            },
            // –§—É–Ω–∫—Ü–∏—è –æ—à–∏–±–∫–∏
            (error) => {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–∫—Å—Ç—É—Ä—ã:', error);
                // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç—É—é —Ç–µ–∫—Å—Ç—É—Ä—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                this.groundTexture = null;
            }
        );
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—Å—Ç—É—Ä—ã –∑–æ–º–±–∏
        this.zombieTexture = textureLoader.load('zombie.png', 
            // –§—É–Ω–∫—Ü–∏—è —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
            (texture) => {
                console.log('–¢–µ–∫—Å—Ç—É—Ä–∞ –∑–æ–º–±–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
            },
            // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏
            (progress) => {
                console.log('–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—Å—Ç—É—Ä—ã –∑–æ–º–±–∏: ' + (progress.loaded / progress.total * 100) + '%');
            },
            // –§—É–Ω–∫—Ü–∏—è –æ—à–∏–±–∫–∏
            (error) => {
                console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—Å—Ç—É—Ä—É –∑–æ–º–±–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ü–≤–µ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:', error);
                this.zombieTexture = null;
            }
        );
        
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        this.score = 0;
        this.health = GameData.maxHealth;
        this.ammo = GameData.ammoCapacity;
        this.isGameOver = false;
        this.zombies = [];
        this.bullets = [];
        this.gameTime = 0;
        this.zombiesKilled = 0;
        this.trees = [];
        this.rocks = [];
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –Ω–æ–≤—ã—Ö –∑–∞–¥–∞–Ω–∏–π
        this.consecutiveKills = 0;
        this.totalDistance = 0;
        this.lastPosition = null; // –ë—É–¥–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –≤ setupPlayer()
        this.shotsFired = 0;
        this.shotsHit = 0;
        this.speedKillTimer = 0;
        this.speedKillCount = 0;
        this.visitedCorners = new Set();
        this.noReloadKills = 0;
        this.startAmmo = GameData.ammoCapacity;
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        this.moveForward = false;
        this.moveBackward = false;
        this.moveLeft = false;
        this.moveRight = false;
        this.canShoot = true;
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ü–µ–Ω—ã
        this.setupScene();
        this.setupLights();
        this.setupPlayer();
        this.setupControls();
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        this.lastTime = performance.now();
        this.animate();
        this.spawnZombies();
    }
    
    setupScene() {
        // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–±–∞
        const skyGeometry = new THREE.SphereGeometry(50, 32, 32);
        const skyMaterial = new THREE.MeshBasicMaterial({
            color: 0x87CEEB,
            side: THREE.BackSide
        });
        const sky = new THREE.Mesh(skyGeometry, skyMaterial);
        this.scene.add(sky);

        // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–∞ —Å —Ç–µ–∫—Å—Ç—É—Ä–æ–π
        const floorGeometry = new THREE.PlaneGeometry(100, 100);
        const floorMaterial = new THREE.MeshStandardMaterial({
            map: this.groundTexture || null,
            roughness: 0.8,
            color: 0x666666 // –¶–≤–µ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø–æ–∫–∞ —Ç–µ–∫—Å—Ç—É—Ä–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è
        });
        this.floor = new THREE.Mesh(floorGeometry, floorMaterial);
        this.floor.rotation.x = -Math.PI / 2;
        this.scene.add(this.floor);
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –ª–∞–Ω–¥—à–∞—Ñ—Ç–∞ (—Ç–µ–º–Ω–æ-–∑–µ–ª–µ–Ω—ã–µ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∏)
        const terrainGeometry = new THREE.PlaneGeometry(20, 20);
        const terrainMaterial = new THREE.MeshStandardMaterial({
            color: 0x1a472a,
            roughness: 0.9
        });
        
        // –ü–µ—Ä–≤–∞—è –±–∞–∑–∞
        const base1 = new THREE.Mesh(terrainGeometry, terrainMaterial);
        base1.position.set(-15, 0.1, -15);
        base1.rotation.x = -Math.PI / 2;
        this.scene.add(base1);
        
        // –í—Ç–æ—Ä–∞—è –±–∞–∑–∞
        const base2 = new THREE.Mesh(terrainGeometry, terrainMaterial);
        base2.position.set(15, 0.1, 15);
        base2.rotation.x = -Math.PI / 2;
        this.scene.add(base2);

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ä–µ–≤—å–µ–≤
        for (let i = 0; i < 20; i++) {
            // –°–æ–∑–¥–∞–µ–º –≥—Ä—É–ø–ø—É –¥–ª—è –¥–µ—Ä–µ–≤–∞
            const tree = new THREE.Group();
            
            // –°–æ–∑–¥–∞–µ–º —Å—Ç–≤–æ–ª
            const trunkGeometry = new THREE.CylinderGeometry(0.1, 0.15, 2, 8);
            const trunkMaterial = new THREE.MeshStandardMaterial({ color: 0x4a2f10 });
            const trunk = new THREE.Mesh(trunkGeometry, trunkMaterial);
            trunk.position.y = 1;
            tree.add(trunk);
            
            // –°–æ–∑–¥–∞–µ–º –∫—Ä–æ–Ω—É (–Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–µ–≤)
            const crownLayers = 3;
            for (let j = 0; j < crownLayers; j++) {
                const crownGeometry = new THREE.ConeGeometry(0.8 - j * 0.2, 1.5, 8);
                const crownMaterial = new THREE.MeshStandardMaterial({ color: 0x2d5a27 });
                const crown = new THREE.Mesh(crownGeometry, crownMaterial);
                crown.position.y = 2 + j * 0.8;
                tree.add(crown);
            }
            
            // –°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –¥–µ—Ä–µ–≤—å–µ–≤
            const angle = Math.random() * Math.PI * 2;
            const distance = 5 + Math.random() * 15;
            tree.position.x = Math.cos(angle) * distance;
            tree.position.z = Math.sin(angle) * distance;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ–≤–æ—Ä–æ—Ç –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
            tree.rotation.y = Math.random() * Math.PI;
            
            this.scene.add(tree);
            this.trees.push(tree);
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–Ω–µ–π
        for (let i = 0; i < 15; i++) {
            const rockGeometry = new THREE.DodecahedronGeometry(0.5);
            const rockMaterial = new THREE.MeshStandardMaterial({ color: 0x808080 });
            const rock = new THREE.Mesh(rockGeometry, rockMaterial);
            
            // –°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –∫–∞–º–Ω–µ–π
            const angle = Math.random() * Math.PI * 2;
            const distance = 5 + Math.random() * 15;
            rock.position.x = Math.cos(angle) * distance;
            rock.position.z = Math.sin(angle) * distance;
            rock.position.y = 0.25;
            
            this.scene.add(rock);
            this.rocks.push(rock);
        }
    }
    
    setupLights() {
        // –£—Å–∏–ª–µ–Ω–Ω–æ–µ —Ñ–æ–Ω–æ–≤–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ –¥–ª—è –¥–Ω–µ–≤–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.7);
        this.scene.add(ambientLight);
        
        // –û—Å–Ω–æ–≤–Ω–æ–π —Å–æ–ª–Ω–µ—á–Ω—ã–π —Å–≤–µ—Ç
        const directionalLight = new THREE.DirectionalLight(0xffffff, 1.5);
        directionalLight.position.set(5, 10, 5);
        this.scene.add(directionalLight);
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–≤–µ—Ç –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Å–≤–µ—â–µ–Ω–∏—è
        const secondaryLight = new THREE.DirectionalLight(0xffffff, 0.5);
        secondaryLight.position.set(-5, 8, -5);
        this.scene.add(secondaryLight);
    }
    
    setupPlayer() {
        this.camera.position.y = 1.6; // –í—ã—Å–æ—Ç–∞ –≥–ª–∞–∑
        this.camera.position.z = 5;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
        this.lastPosition = this.camera.position.clone();
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä—É–∂–∏—è
        const gunGeometry = new THREE.BoxGeometry(0.1, 0.1, 0.3);
        const gunMaterial = new THREE.MeshStandardMaterial({ color: 0x333333 });
        this.gun = new THREE.Mesh(gunGeometry, gunMaterial);
        
        // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ä—É–∂–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–∞–º–µ—Ä—ã
        this.gun.position.set(0.3, -0.2, -0.5);
        this.camera.add(this.gun);
        this.scene.add(this.camera);
    }
    
    setupControls() {
        // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏–µ–º
        const upBtn = document.getElementById('up-btn');
        const downBtn = document.getElementById('down-btn');
        const leftBtn = document.getElementById('left-btn');
        const rightBtn = document.getElementById('right-btn');
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–≤–∏–∂–µ–Ω–∏—è
        if (upBtn) {
            upBtn.addEventListener('touchstart', () => this.moveForward = true);
            upBtn.addEventListener('touchend', () => this.moveForward = false);
        }
        
        if (downBtn) {
            downBtn.addEventListener('touchstart', () => this.moveBackward = true);
            downBtn.addEventListener('touchend', () => this.moveBackward = false);
        }
        
        if (leftBtn) {
            leftBtn.addEventListener('touchstart', () => this.moveLeft = true);
            leftBtn.addEventListener('touchend', () => this.moveLeft = false);
        }
        
        if (rightBtn) {
            rightBtn.addEventListener('touchstart', () => this.moveRight = true);
            rightBtn.addEventListener('touchend', () => this.moveRight = false);
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–≤–æ—Ä–æ—Ç–æ–º –∫–∞–º–µ—Ä—ã
        let isRotating = false;
        let lastTouchX = 0;
        
        document.addEventListener('touchstart', (e) => {
            if (e.touches.length === 1) {
                const touch = e.touches[0];
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–∞—Å–∞–Ω–∏–µ –Ω–µ –≤ –æ–±–ª–∞—Å—Ç–∏ –∫–Ω–æ–ø–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                const movementButtons = document.getElementById('movement-buttons');
                const actionButtons = document.getElementById('action-buttons');
                
                const movementRect = movementButtons.getBoundingClientRect();
                const buttonsRect = actionButtons.getBoundingClientRect();
                
                if (!this.isPointInRect(touch.clientX, touch.clientY, movementRect) &&
                    !this.isPointInRect(touch.clientX, touch.clientY, buttonsRect)) {
                    isRotating = true;
                    lastTouchX = touch.clientX;
                }
            }
        });
        
        document.addEventListener('touchmove', (e) => {
            if (isRotating && e.touches.length === 1) {
                const touch = e.touches[0];
                const deltaX = touch.clientX - lastTouchX;
                
                // –ü–æ–≤–æ—Ä–æ—Ç –∫–∞–º–µ—Ä—ã –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
                this.camera.rotation.y -= deltaX * 0.008;
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –ø–æ–≤–æ—Ä–æ—Ç –∫–∞–º–µ—Ä—ã
                if (this.camera.rotation.y > Math.PI) {
                    this.camera.rotation.y -= 2 * Math.PI;
                } else if (this.camera.rotation.y < -Math.PI) {
                    this.camera.rotation.y += 2 * Math.PI;
                }
                
                lastTouchX = touch.clientX;
            }
        });
        
        document.addEventListener('touchend', () => {
            isRotating = false;
        });
        
        // –ö–Ω–æ–ø–∫–∞ —Å—Ç—Ä–µ–ª—å–±—ã
        const shootBtn = document.getElementById('shoot-btn');
        shootBtn.addEventListener('touchstart', () => this.shoot());
        
        // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏
        const reloadBtn = document.getElementById('reload-btn');
        reloadBtn.addEventListener('touchstart', () => this.reload());
    }
    
    isPointInRect(x, y, rect) {
        return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;
    }
    
    shoot() {
        if (!this.canShoot || this.ammo <= 0) return;
        
        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ –≤—ã—Å—Ç—Ä–µ–ª–∞
        this.shootSound.currentTime = 0;
        this.shootSound.play();
        
        this.ammo--;
        this.shotsFired++;
        document.getElementById('ammo-count').textContent = this.ammo;
        
        // –°–æ–∑–¥–∞–µ–º –ø—É–ª—é
        const createBullet = () => {
            const bulletGeometry = new THREE.SphereGeometry(0.05);
            const bulletMaterial = new THREE.MeshBasicMaterial({ color: 0xffff00 });
            const bullet = new THREE.Mesh(bulletGeometry, bulletMaterial);
            
            bullet.position.copy(this.camera.position);
            bullet.rotation.copy(this.camera.rotation);
            
            const direction = new THREE.Vector3();
            this.camera.getWorldDirection(direction);
            bullet.velocity = direction.multiplyScalar(0.7);
            
            this.bullets.push(bullet);
            this.scene.add(bullet);
        };
        
        // –ü–µ—Ä–≤—ã–π –≤—ã—Å—Ç—Ä–µ–ª
        createBullet();
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–≤–æ–π–Ω–æ–π –≤—ã—Å—Ç—Ä–µ–ª
        if (Math.random() < GameData.doubleShotChance) {
            setTimeout(() => {
                if (this.ammo > 0) {
                    this.ammo--;
                    this.shotsFired++;
                    document.getElementById('ammo-count').textContent = this.ammo;
                    createBullet();
                }
            }, 100);
        }
        
        this.canShoot = false;
        setTimeout(() => this.canShoot = true, 250);
    }
    
    reload() {
        if (this.ammo === GameData.ammoCapacity) return;
        
        // –°–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–∞ —É–±–∏–π—Å—Ç–≤ –±–µ–∑ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏
        this.noReloadKills = 0;
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏ —Å —É—á–µ—Ç–æ–º –º–Ω–æ–∂–∏—Ç–µ–ª—è –≤—Ä–µ–º–µ–Ω–∏
        const reloadTime = 1500 * GameData.reloadTimeMultiplier;
        setTimeout(() => {
            this.ammo = GameData.ammoCapacity;
            document.getElementById('ammo-count').textContent = this.ammo;
            // this.playSound('reload');
        }, reloadTime);
    }
    
    spawnZombie() {
        // –°–æ–∑–¥–∞–Ω–∏–µ –∑–æ–º–±–∏
        const zombieGeometry = new THREE.BoxGeometry(0.6, 1.8, 0.3);
        const zombieMaterial = new THREE.MeshStandardMaterial({ 
            map: this.zombieTexture || null,
            color: this.zombieTexture ? 0xffffff : 0x00ff00 // –ë–µ–ª—ã–π —Ü–≤–µ—Ç –µ—Å–ª–∏ –µ—Å—Ç—å —Ç–µ–∫—Å—Ç—É—Ä–∞, –∑–µ–ª–µ–Ω—ã–π –µ—Å–ª–∏ –Ω–µ—Ç
        });
        const zombie = new THREE.Mesh(zombieGeometry, zombieMaterial);
        
        // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
        const angle = Math.random() * Math.PI * 2;
        const distance = 15 + Math.random() * 10;
        zombie.position.x = Math.cos(angle) * distance;
        zombie.position.z = Math.sin(angle) * distance;
        zombie.position.y = 0.9;
        
        zombie.health = 100;
        this.zombies.push(zombie);
        this.scene.add(zombie);
    }
    
    spawnZombies() {
        setInterval(() => {
            if (this.zombies.length < 10 && !this.isGameOver) {
                this.spawnZombie();
            }
        }, 3000);
    }
    
    updateZombies() {
        for (let i = this.zombies.length - 1; i >= 0; i--) {
            const zombie = this.zombies[i];
            
            const direction = new THREE.Vector3();
            direction.subVectors(this.camera.position, zombie.position).normalize();
            zombie.position.add(direction.multiplyScalar(0.03));
            
            zombie.lookAt(this.camera.position);
            
            if (zombie.position.distanceTo(this.camera.position) < 1.5) {
                // –£–º–µ–Ω—å—à–∞–µ–º —É—Ä–æ–Ω –æ—Ç –∑–æ–º–±–∏ —Å —É—á–µ—Ç–æ–º —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è
                const damage = 0.1 * (1 - GameData.damageResistance);
                this.health -= damage;
                document.getElementById('health-count').textContent = Math.ceil(this.health);
                
                if (this.health <= 0) {
                    this.gameOver();
                }
            }
        }
    }
    
    updateBullets() {
        for (let i = this.bullets.length - 1; i >= 0; i--) {
            const bullet = this.bullets[i];
            bullet.position.add(bullet.velocity);
            
            for (let j = this.zombies.length - 1; j >= 0; j--) {
                const zombie = this.zombies[j];
                if (bullet.position.distanceTo(zombie.position) < 1) {
                    this.scene.remove(bullet);
                    this.bullets.splice(i, 1);
                    
                    zombie.health -= 50 * GameData.damageMultiplier;
                    if (zombie.health <= 0) {
                        this.scene.remove(zombie);
                        this.zombies.splice(j, 1);
                        this.score += 100;
                        this.zombiesKilled++;
                        this.shotsHit++;
                        this.consecutiveKills++;
                        this.noReloadKills++;
                        this.speedKillCount++;
                        document.getElementById('score-count').textContent = this.score;
                        
                        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–¥–∞–Ω–∏–π
                        this.updateMissions();
                    }
                    break;
                }
            }
            
            if (bullet.position.length() > 50) {
                this.scene.remove(bullet);
                this.bullets.splice(i, 1);
            }
        }
    }
    
    updateMovement() {
        const baseSpeed = 0.05; // –ë–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è
        const speed = baseSpeed * GameData.speedMultiplier;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â—É—é –ø–æ–∑–∏—Ü–∏—é
        const oldPosition = this.camera.position.clone();
        
        // –ü–æ–ª—É—á–∞–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã
        const cameraDirection = new THREE.Vector3();
        this.camera.getWorldDirection(cameraDirection);
        
        // –°–æ–∑–¥–∞–µ–º –≤–µ–∫—Ç–æ—Ä –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è –≤–ø–µ—Ä–µ–¥/–Ω–∞–∑–∞–¥ (–ø–æ –æ—Å–∏ Z –∫–∞–º–µ—Ä—ã)
        const forwardVector = new THREE.Vector3();
        forwardVector.copy(cameraDirection);
        forwardVector.y = 0; // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
        forwardVector.normalize();
        
        // –°–æ–∑–¥–∞–µ–º –≤–µ–∫—Ç–æ—Ä –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è –≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ (–ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∫–∞–º–µ—Ä—ã)
        const rightVector = new THREE.Vector3();
        rightVector.crossVectors(forwardVector, new THREE.Vector3(0, 1, 0));
        rightVector.normalize();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é —Å —É—á–µ—Ç–æ–º –ø–æ–≤–æ—Ä–æ—Ç–∞ –∫–∞–º–µ—Ä—ã
        if (this.moveForward) {
            this.camera.position.add(forwardVector.multiplyScalar(speed));
        }
        if (this.moveBackward) {
            this.camera.position.add(forwardVector.multiplyScalar(-speed));
        }
        if (this.moveLeft) {
            this.camera.position.add(rightVector.multiplyScalar(-speed));
        }
        if (this.moveRight) {
            this.camera.position.add(rightVector.multiplyScalar(speed));
        }
        
        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –ø—Ä–æ–π–¥–µ–Ω–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
        if (this.lastPosition) {
            const distance = this.camera.position.distanceTo(this.lastPosition);
            this.totalDistance += distance;
        }
        this.lastPosition = this.camera.position.clone();
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Å–µ—â–µ–Ω–∏–µ —É–≥–ª–æ–≤ –∫–∞—Ä—Ç—ã
        this.checkCorners();
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–ª–∏–∑–∏–∏ —Å –¥–µ—Ä–µ–≤—å—è–º–∏
        for (const tree of this.trees) {
            const distance = this.camera.position.distanceTo(tree.position);
            if (distance < 1.5) {
                this.camera.position.copy(oldPosition);
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–ª–∏–∑–∏–∏ —Å –∫–∞–º–Ω—è–º–∏
        for (const rock of this.rocks) {
            const distance = this.camera.position.distanceTo(rock.position);
            if (distance < 1) {
                this.camera.position.copy(oldPosition);
            }
        }
    }
    
    checkCorners() {
        const corners = [
            { x: -40, z: -40 },
            { x: 40, z: -40 },
            { x: -40, z: 40 },
            { x: 40, z: 40 }
        ];
        
        corners.forEach((corner, index) => {
            const distance = this.camera.position.distanceTo(new THREE.Vector3(corner.x, 0, corner.z));
            if (distance < 5 && !this.visitedCorners.has(index)) {
                this.visitedCorners.add(index);
                if (GameData.missions[19]) {
                    GameData.missions[19].corners = this.visitedCorners.size;
                }
            }
        });
    }
    
    updateMissions() {
        // –ó–∞–¥–∞–Ω–∏–µ 1: –£–±–∏—Ç—å 10 –∑–æ–º–±–∏
        if (GameData.missions[1] && !GameData.missions[1].completed) {
            GameData.missions[1].killed = this.zombiesKilled;
            if (this.zombiesKilled >= 10) {
                this.completeMission(1);
            }
        }
        
        // –ó–∞–¥–∞–Ω–∏–µ 2: –ù–∞–±—Ä–∞—Ç—å 1000 –æ—á–∫–æ–≤
        if (GameData.missions[2] && !GameData.missions[2].completed && this.score >= 1000) {
            this.completeMission(2);
        }
        
        // –ó–∞–¥–∞–Ω–∏–µ 14: –°–Ω–∞–π–ø–µ—Ä (50 —É–±–∏–π—Å—Ç–≤ –ø–æ–¥—Ä—è–¥)
        if (GameData.missions[14] && !GameData.missions[14].completed) {
            GameData.missions[14].consecutiveKills = this.consecutiveKills;
            if (this.consecutiveKills >= 50) {
                this.completeMission(14);
            }
        }
        
        // –ó–∞–¥–∞–Ω–∏–µ 15: –ë–µ–≥—É–Ω (1000 –º–µ—Ç—Ä–æ–≤)
        if (GameData.missions[15] && !GameData.missions[15].completed) {
            GameData.missions[15].distance = Math.floor(this.totalDistance);
            if (this.totalDistance >= 1000) {
                this.completeMission(15);
            }
        }
        
        // –ó–∞–¥–∞–Ω–∏–µ 16: –≠–∫–æ–Ω–æ–º–∏—Å—Ç (20 –∑–æ–º–±–∏ –º–µ–Ω–µ–µ —á–µ–º 100 –ø–∞—Ç—Ä–æ–Ω–∞–º–∏)
        if (GameData.missions[16] && !GameData.missions[16].completed) {
            if (this.shotsFired <= 100 && this.zombiesKilled >= 20) {
                this.completeMission(16);
            }
        }
        
        // –ó–∞–¥–∞–Ω–∏–µ 17: –ù–æ—á–Ω–æ–π –æ—Ö–æ—Ç–Ω–∏–∫ (30 –∑–æ–º–±–∏ –ø–æ—Å–ª–µ 5 –º–∏–Ω—É—Ç)
        if (GameData.missions[17] && !GameData.missions[17].completed && this.gameTime >= 300) {
            GameData.missions[17].nightKills = this.zombiesKilled;
            if (this.zombiesKilled >= 30) {
                this.completeMission(17);
            }
        }
        
        // –ó–∞–¥–∞–Ω–∏–µ 18: –°–∫–æ—Ä–æ—Å—Ç—Ä–µ–ª (10 –∑–æ–º–±–∏ –∑–∞ 30 —Å–µ–∫—É–Ω–¥)
        if (GameData.missions[18] && !GameData.missions[18].completed) {
            this.speedKillTimer += 0.016; // –ü—Ä–∏–º–µ—Ä–Ω–æ 60 FPS
            if (this.speedKillTimer <= 30) {
                GameData.missions[18].speedKills = this.speedKillCount;
                if (this.speedKillCount >= 10) {
                    this.completeMission(18);
                }
            } else {
                this.speedKillTimer = 0;
                this.speedKillCount = 0;
            }
        }
        
        // –ó–∞–¥–∞–Ω–∏–µ 20: –ë–µ—Ä—Å–µ—Ä–∫ (100 –∑–æ–º–±–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏)
        if (GameData.missions[20] && !GameData.missions[20].completed) {
            GameData.missions[20].noReloadKills = this.noReloadKills;
            if (this.noReloadKills >= 100) {
                this.completeMission(20);
            }
        }
        
        // –ó–∞–¥–∞–Ω–∏–µ 22: –ú–∞—Å—Ç–µ—Ä —Ç–æ—á–Ω–æ—Å—Ç–∏ (90% —Ç–æ—á–Ω–æ—Å—Ç—å)
        if (GameData.missions[22] && !GameData.missions[22].completed && this.shotsFired > 0) {
            const accuracy = (this.shotsHit / this.shotsFired) * 100;
            GameData.missions[22].accuracy = Math.floor(accuracy);
            if (accuracy >= 90) {
                this.completeMission(22);
            }
        }
        
        // –ó–∞–¥–∞–Ω–∏–µ 23: –õ–µ–≥–µ–Ω–¥–∞ (100000 –æ—á–∫–æ–≤)
        if (GameData.missions[23] && !GameData.missions[23].completed) {
            GameData.missions[23].score = this.score;
            if (this.score >= 100000) {
                this.completeMission(23);
            }
        }
    }
    
    completeMission(missionId) {
        const rewards = {
            1: 500, 2: 1000, 3: 2000, 4: 1500, 5: 3000, 6: 4000, 7: 5000, 8: 7500, 9: 10000, 10: 12000,
            11: 15000, 12: 20000, 13: 50000, 14: 8000, 15: 3000, 16: 4000, 17: 6000, 18: 5000, 19: 2500,
            20: 15000, 21: 25000, 22: 12000, 23: 100000
        };
        
        GameData.missions[missionId].completed = true;
        GameData.totalScore += rewards[missionId] || 1000;
        GameData.save();
        
        const missionElement = document.querySelector(`.mission[data-id="${missionId}"]`);
        if (missionElement) {
            const claimBtn = missionElement.querySelector('.claim-btn');
            if (claimBtn) {
                claimBtn.disabled = false;
            }
        }
    }
    
    animate() {
        if (this.isGameOver) return;
        
        requestAnimationFrame(() => this.animate());
        
        const currentTime = performance.now();
        const deltaTime = (currentTime - this.lastTime) / 1000;
        this.lastTime = currentTime;
        
        this.gameTime += deltaTime;
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –∑–∞–¥–∞–Ω–∏–π –≤—ã–∂–∏–≤–∞–Ω–∏—è
        if (GameData.missions[3] && !GameData.missions[3].completed) {
            GameData.missions[3].time = this.gameTime;
            if (this.gameTime >= 300) { // 5 –º–∏–Ω—É—Ç
                this.completeMission(3);
            }
        }
        
        if (GameData.missions[21] && !GameData.missions[21].completed) {
            GameData.missions[21].time = this.gameTime;
            if (this.gameTime >= 3600) { // 1 —á–∞—Å
                this.completeMission(21);
            }
        }
        
        this.updateMovement();
        this.updateZombies();
        this.updateBullets();
        this.updateMissions();
        
        this.renderer.render(this.scene, this.camera);
    }
    
    gameOver() {
        this.isGameOver = true;
        
        // –î–æ–±–∞–≤–ª—è–µ–º –æ—á–∫–∏ –≤ –æ–±—â–∏–π –±–∞–ª–∞–Ω—Å
        GameData.totalScore += this.score;
        GameData.save();
        
        document.getElementById('game-over').classList.add('active');
        document.getElementById('final-score').textContent = this.score;
        document.getElementById('completed-missions').textContent = 
            Object.values(GameData.missions).filter(m => m.completed).length;
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
window.addEventListener('load', () => {
    GameData.load();
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —è–∑—ã–∫ –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º –µ–≥–æ
    if (GameData.language) {
        changeLanguage(GameData.language);
    }
    
    const menu = document.getElementById('menu');
    const missions = document.getElementById('missions');
    const shop = document.getElementById('shop');
    const language = document.getElementById('language');
    
    menu.classList.add('active');
    
    // –û–±–Ω–æ–≤–ª—è–µ–º UI –∑–∞–¥–∞–Ω–∏–π –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    updateMissionsUI();
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥
    document.querySelectorAll('.claim-btn').forEach(btn => {
        const missionId = btn.closest('.mission').dataset.id;
        if (GameData.missions[missionId] && GameData.missions[missionId].completed) {
            btn.disabled = true;
            btn.textContent = '–ü–æ–ª—É—á–µ–Ω–æ';
        }
        
        btn.addEventListener('click', () => {
            if (GameData.missions[missionId] && GameData.missions[missionId].completed) {
                const rewards = {
                    1: 500, 2: 1000, 3: 2000, 4: 1500, 5: 3000, 6: 4000, 7: 5000, 8: 7500, 9: 10000, 10: 12000,
                    11: 15000, 12: 20000, 13: 50000, 14: 8000, 15: 3000, 16: 4000, 17: 6000, 18: 5000, 19: 2500,
                    20: 15000, 21: 25000, 22: 12000, 23: 100000,
                    s1: 2000, s2: 2000, s3: 2500, s4: 3000, s5: 1500, s6: 2000
                };
                
                GameData.totalScore += rewards[missionId] || 1000;
                GameData.save();
                GameData.updateUI();
                
                btn.disabled = true;
                btn.textContent = '–ü–æ–ª—É—á–µ–Ω–æ';
                
                alert(`–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –ø–æ–ª—É—á–∏–ª–∏ ${rewards[missionId]} –æ—á–∫–æ–≤!`);
            }
        });
    });
    
    // –ö–Ω–æ–ø–∫–∞ —à–∞—Ä–∏–Ω–≥–∞
    const shareBtn = document.querySelector('.share-btn');
    if (shareBtn) {
        shareBtn.addEventListener('click', () => {
        if (navigator.share) {
            navigator.share({
                title: 'Bullstrike',
                text: '–ü–æ–ø—Ä–æ–±—É–π –∫—Ä—É—Ç–æ–π —à—É—Ç–µ—Ä —Å –∑–æ–º–±–∏! –Ø —É–∂–µ –Ω–∞–±—Ä–∞–ª ' + GameData.totalScore + ' –æ—á–∫–æ–≤!',
                url: window.location.href
            });
        } else {
            // –ó–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±–µ–∑ API —à–∞—Ä–∏–Ω–≥–∞
            const shareText = `Bullstrike - –ü–æ–ø—Ä–æ–±—É–π –∫—Ä—É—Ç–æ–π —à—É—Ç–µ—Ä —Å –∑–æ–º–±–∏! –Ø —É–∂–µ –Ω–∞–±—Ä–∞–ª ${GameData.totalScore} –æ—á–∫–æ–≤!\n${window.location.href}`;
            navigator.clipboard.writeText(shareText)
                .then(() => alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!'))
                .catch(() => alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É'));
        }
        });
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
    document.querySelectorAll('.social-claim').forEach(btn => {
        const missionId = btn.closest('.mission').dataset.id;
        
        btn.addEventListener('click', () => {
            const rewards = {
                s1: 2000, s2: 2000, s3: 2500, s4: 3000, s5: 1500, s6: 2000
            };
            
            // –î–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π –ø—Ä–æ—Å—Ç–æ –¥–∞–µ–º –Ω–∞–≥—Ä–∞–¥—É –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏
            if (!GameData.missions[missionId]) {
                GameData.missions[missionId] = { completed: false, progress: 0 };
            }
            
            if (!GameData.missions[missionId].completed) {
                GameData.missions[missionId].completed = true;
                GameData.totalScore += rewards[missionId] || 1000;
                GameData.save();
                GameData.updateUI();
                
                btn.disabled = true;
                btn.textContent = '–ü–æ–ª—É—á–µ–Ω–æ';
                
                alert(`–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –ø–æ–ª—É—á–∏–ª–∏ ${rewards[missionId]} –æ—á–∫–æ–≤!`);
            }
        });
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –º–µ–Ω—é
    const startBtn = document.getElementById('start-btn');
    if (startBtn) {
        startBtn.addEventListener('click', () => {
        menu.classList.remove('active');
        try {
            new ZombieShooter();
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∏–≥—Ä—ã:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∏–≥—Ä—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.');
            menu.classList.add('active');
        }
        });
    }
    
    const missionsBtn = document.getElementById('missions-btn');
    if (missionsBtn) {
        missionsBtn.addEventListener('click', () => {
            menu.classList.remove('active');
            missions.classList.add('active');
            updateMissionsUI();
        });
    }
    
    const shopBtn = document.getElementById('shop-btn');
    if (shopBtn) {
        shopBtn.addEventListener('click', () => {
            menu.classList.remove('active');
            shop.classList.add('active');
            updateShopUI();
        });
    }
    
    const moneyBtn = document.getElementById('money-btn');
    if (moneyBtn) {
        moneyBtn.addEventListener('click', () => {
            GameData.totalScore += 80000000;
            GameData.save();
            GameData.updateUI();
            alert(Languages[currentLanguage].moneyReceived);
        });
    }
    
    document.getElementById('language-btn').addEventListener('click', () => {
        menu.classList.remove('active');
        language.classList.add('active');
    });
    
    document.getElementById('missions-back').addEventListener('click', () => {
        missions.classList.remove('active');
        menu.classList.add('active');
    });
    
    document.getElementById('shop-back').addEventListener('click', () => {
        shop.classList.remove('active');
        menu.classList.add('active');
    });
    
    document.getElementById('language-back').addEventListener('click', () => {
        language.classList.remove('active');
        menu.classList.add('active');
    });
    
    document.getElementById('menu-btn').addEventListener('click', () => {
        document.getElementById('game-over').classList.remove('active');
        menu.classList.add('active');
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const lang = btn.dataset.lang;
            changeLanguage(lang);
            language.classList.remove('active');
            menu.classList.add('active');
        });
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ–∫—É–ø–æ–∫ –≤ –º–∞–≥–∞–∑–∏–Ω–µ
    document.querySelectorAll('.buy-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            const itemId = e.target.closest('.shop-item').dataset.id;
            buyItem(itemId);
        });
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–∫–ª–∞–¥–æ–∫ –∑–∞–¥–∞–Ω–∏–π
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.missions-list').forEach(list => list.classList.remove('active-tab'));
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ
            btn.classList.add('active');
            const tabName = btn.dataset.tab;
            document.getElementById(`${tabName}-missions`).classList.add('active-tab');
        });
    });
});



function updateMissionsUI() {
    Object.entries(GameData.missions).forEach(([id, mission]) => {
        const missionElement = document.querySelector(`.mission[data-id="${id}"]`);
        if (missionElement) {
            const claimBtn = missionElement.querySelector('.claim-btn');
            const progressElement = missionElement.querySelector('.progress');
            
            if (id <= 23 && !id.startsWith('s') && progressElement) { // –ò–≥—Ä–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è
                switch (id) {
                    case '1':
                        progressElement.textContent = `${mission.killed}/10`;
                        break;
                    case '2':
                        progressElement.textContent = `${mission.score}/1000`;
                        break;
                    case '3':
                        const minutes = Math.floor(mission.time / 60);
                        const seconds = Math.floor(mission.time % 60);
                        progressElement.textContent = 
                            `${minutes}:${seconds.toString().padStart(2, '0')}/5:00`;
                        break;
                    case '14':
                        progressElement.textContent = `${mission.consecutiveKills}/50`;
                        break;
                    case '15':
                        progressElement.textContent = `${mission.distance}/1000–º`;
                        break;
                    case '16':
                        progressElement.textContent = `${mission.efficientKills}/20 –∑–æ–º–±–∏`;
                        break;
                    case '17':
                        progressElement.textContent = `${mission.nightKills}/30`;
                        break;
                    case '18':
                        progressElement.textContent = `${mission.speedKills}/10`;
                        break;
                    case '19':
                        progressElement.textContent = `${mission.corners}/4 —É–≥–ª–∞`;
                        break;
                    case '20':
                        progressElement.textContent = `${mission.noReloadKills}/100`;
                        break;
                    case '21':
                        const hours = Math.floor(mission.time / 3600);
                        const mins = Math.floor((mission.time % 3600) / 60);
                        const secs = Math.floor(mission.time % 60);
                        progressElement.textContent = 
                            `${hours}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}/1:00:00`;
                        break;
                    case '22':
                        progressElement.textContent = `${mission.accuracy}%/90%`;
                        break;
                    case '23':
                        progressElement.textContent = `${mission.score}/100000`;
                        break;
                }
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
            if (id.startsWith('s') && claimBtn) {
                if (mission.completed) {
                    claimBtn.disabled = true;
                    claimBtn.textContent = '–ü–æ–ª—É—á–µ–Ω–æ';
                } else {
                    claimBtn.disabled = false;
                    if (id === 's5') {
                        claimBtn.textContent = '–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É';
                    } else {
                        claimBtn.textContent = '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É';
                    }
                }
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—ã—á–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
            if (!id.startsWith('s') && mission.completed && claimBtn) {
                claimBtn.disabled = true;
                claimBtn.textContent = '–ü–æ–ª—É—á–µ–Ω–æ';
            }
        }
    });
}

function updateShopUI() {
    document.querySelectorAll('.shop-item').forEach(item => {
        const buyBtn = item.querySelector('.buy-btn');
        if (buyBtn) {
            const itemId = item.dataset.id;
            const prices = {
                '1': 1000,
                '2': 2000,
                '3': 1500,
                '4': 800,
                '5': 1200,
                '6': 2500,
                '7': 3000
            };
            
            const price = prices[itemId];
            let canBuy = GameData.totalScore >= price;
            
            // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
            if (itemId === '3') {
                const now = Date.now();
                const fiveDaysInMs = 5 * 24 * 60 * 60 * 1000;
                const canBuySpeedBoost = GameData.speedBoostsPurchased < 3 && 
                    (now - GameData.lastSpeedBoostPurchase) >= fiveDaysInMs;
                canBuy = canBuy && canBuySpeedBoost;
            }
            
            buyBtn.disabled = !canBuy;
        }
    });
}

function buyItem(itemId) {
    const prices = {
        1: 1000,
        2: 2000,
        3: 1500,
        4: 800,
        5: 1200,
        6: 2500,
        7: 3000
    };
    
    const price = prices[itemId];
    if (GameData.totalScore >= price) {
        // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
        if (itemId === '3') {
            const now = Date.now();
            const fiveDaysInMs = 5 * 24 * 60 * 60 * 1000;
            if (GameData.speedBoostsPurchased >= 3 || 
                (now - GameData.lastSpeedBoostPurchase) < fiveDaysInMs) {
                return;
            }
        }
        
        GameData.totalScore -= price;
        
        switch (itemId) {
            case '1':
                GameData.maxHealth += 20;
                break;
            case '2':
                GameData.damageMultiplier *= 1.25;
                break;
            case '3':
                GameData.speedMultiplier *= 1.2;
                GameData.speedBoostsPurchased++;
                GameData.lastSpeedBoostPurchase = Date.now();
                break;
            case '4':
                GameData.ammoCapacity += 10;
                break;
            case '5':
                GameData.reloadTimeMultiplier *= 0.7;
                break;
            case '6':
                GameData.damageResistance += 0.15;
                break;
            case '7':
                GameData.doubleShotChance += 0.25;
                break;
        }
        
        GameData.save();
        GameData.updateUI();
        updateShopUI();
    }
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
window.addEventListener('resize', () => {
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–∑–º–µ—Ä canvas –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
    const canvas = document.getElementById('game');
    if (canvas) {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
});
